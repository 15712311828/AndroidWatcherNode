<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<head>
    <title>Android Watcher</title>
    <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/video-js.css"/>
    <link rel="stylesheet" href="/css/live.css"/>
    <script src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
    <script src="//cdn.bootcss.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="/js/video.min.js"></script>
    <script src="/js/videojs-ie8.min.js"></script>
    <script>
        $(function(){
            $.ajax({
                type: "POST",
                url: "/api/user/name",
                dataType: "json",
                success: function(result){
                    if(result.status==0){
                        var name=result.data;
                    }
                    else{
                        alert("未登录");
                        $(location).attr('href', '/');
                    }
                }
            });
            $.ajax({
                type: "POST",
                url: "/api/device/name",
                dataType: "json",
                success: function(result){
                    if(result.status==0){
                        var name=result.data;
                        var video="<video id=\"video\" class=\"video-js\" controls=\"controls\" autoplay=\"false\" preload=\"no\" width=\"640px\" height=\"360px\" data-setup=\"{}\"/>";
                        $("#video-div").html(video);
                        var source = $("<source src=\""+ "rtmp://118.89.229.227/live/" + name+"\"/>");
                        $("#video").append(source);
                        var warn="<p>不支持手机浏览器播放，电脑无法播放请尝试打开flash</p>";
                        $("#video-div").append(warn);
                    }
                    else{
                        alert("未选择设备");
                        $(location).attr('href', '/webapp/menu');
                    }
                }
            });
        });
    </script>
</head>
<body>
    <div class="video-div" id="video-div"/>
</body>
